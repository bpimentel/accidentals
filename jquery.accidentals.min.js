/*
	jQuery Accidentals
	Copyright 2012 by Bret Pimentel http://bretpimentel.com
	Available under MIT license. See LICENSE.txt for more information.
*/

(function(c){c.fn.accidentals=function(a){function k(a,c){for(var d in a)a.hasOwnProperty(d)&&c(d,a[d])}function l(b,j,d){var e;if(!a.ignoreWithin||a.ignoreWithin&&0===c(b).closest(a.ignoreWithin).length)3===b.nodeType?(e=b.nodeValue.replace(j,d),/</.test(e)?c(b).before(e).remove():b.nodeValue=e):1===b.nodeType&&c(b).contents().each(function(){l(this,j,d)})}var m={doubleFlat:{text:"-double-flat","b#":"bb",replacement:"\ud834\udd2b"},doubleSharp:{text:"-double-sharp","b#":"##",replacement:"\ud834\udd2a"},
natural:{text:"-natural","b#":"nat",replacement:"\u266e"},flat:{text:"-flat","b#":"b",replacement:"\u266d"},sharp:{text:"-sharp","b#":"#",replacement:"\u266f"}};a=c.extend(!0,{accidentalClassBase:"accidental",accidentalWrap:'<span class="accidental" />',caseSensitive:!1,ignoreWithin:".no-accidentals",inputTypes:["text"],noteNames:"[A-H]",noteNameWrap:"",outerWrap:""},a);a.caseSensitive=a.caseSensitive?"":"i";return this.each(function(){var b=c(this);k(a.inputTypes,function(j,d){k(m,function(e,f){b.contents().each(function(){var b;
l(this,RegExp("\\b("+a.noteNames+")("+f[d]+")(?=(s)?(\\b|\\s|\\W|$))","g"+a.caseSensitive),function(d,e){var g=e,h=f.replacement;a.noteNameWrap&&(g=c(a.noteNameWrap).text(g).wrap("<div />").parent().html());a.accidentalWrap&&(b=a.accidentalClassBase?f.text:f.text.replace(/^-/,""),h=c(a.accidentalWrap).addClass(a.accidentalClassBase+b).text(h).wrap("<div />").parent().html());return a.outerWrap?c(a.outerWrap).html(g+h).wrap("<div />").parent().html():g+h})})})})})}})(jQuery);